" ==============================
" IdeaVim Configuration
" ==============================

" ---------------------
" Leader Key
" ---------------------
let mapleader=' '
let maplocalleader=' '

" ---------------------
" Generic Vim Settings
" ---------------------
set scrolloff=8             " Keep 8 lines above/below cursor
set visualbell              " Use visual bell instead of beep
set ignorecase              " Case-insensitive search
set smartcase               " Unless uppercase used
set timeoutlen=400          " Timeout for mapped key sequences
set whichwrap+=<,>,h,l,[,]  " Allow cursor wrapping
set clipboard+=unnamedplus  " Use system clipboard (handled automatically in IdeaVim)
set hlsearch                " Highlight search matches
set incsearch               " Incremental search
set foldmethod=indent       " Folding based on indentation
set autoindent              " Auto-indent new lines
set tabstop=4               " Tab width
set shiftwidth=4            " Indent width
set expandtab               " Use spaces instead of tabs

" ---------------------
" Plugins
" ---------------------
Plug 'tpope/vim-surround'
Plug 'tpope/vim-commentary'
Plug 'machakann/vim-highlightedyank'
Plug 'justinmk/vim-sneak'
Plug 'vim-scripts/argtextobj.vim'
Plug 'kana/vim-textobj-entire'
Plug 'vim-scripts/ReplaceWithRegister'

" ---------------------
" Idea-specific Settings
" ---------------------
set ideajoin
set ideastatusicon=gray
set idearefactormode=keep

" ---------------------
" Motion / Navigation
" ---------------------
" Move to beginning/end of line
nmap H ^
nmap L $
vmap H ^
vmap L $

" Move selected text up/down (visual mode)
vmap J :m '>+1<CR>gv=gv
vmap K :m '<-2<CR>gv=gv

" ---------------------
" Replace Selection Without Yanking
" ---------------------
vnoremap <leader>p "_dP

" ---------------------
" Yank to System Clipboard
" ---------------------
nnoremap <leader>y "+y
vnoremap <leader>y "+y
nnoremap <leader>Y "+Y

" ---------------------
" Search Highlight & Redraw
" ---------------------
nnoremap <C-L> :nohlsearch<CR><C-L>
nnoremap n nzzzv
nnoremap N Nzzzv

" ---------------------
" Action Markers / Diagnostics
" ---------------------
nmap ]d <Action>(GotoNextError)         " Go to next diagnostic
nmap [d <Action>(GotoPreviousError)     " Go to previous diagnostic

" ---------------------
" Quick Open / Search (Telescope-like)
" ---------------------
nmap <leader>ff <Action>(GotoFile)              " Fuzzy find files
nmap <leader>fr <Action>(RecentFiles)           " Recent files
nmap <leader>sg <Action>(FindInPath)            " Search text in files
nmap <leader>/ <Action>(Find)                   " Command find
nmap g/ <Action>(FindInPath)                    " Quick text search
nmap <leader>e <Action>(ShowProblems)           " Show problems
nmap <leader>sd <Action>(ShowErrorDescription)  " Show error details

" ---------------------
" LSP / Language Features (Zed-style)
" ---------------------
nmap gd <Action>(GotoDeclaration)             " Go to definition
nmap gD <Action>(QuickDefinition)             " Go to declaration (peek)
nmap gy <Action>(GotoTypeDeclaration)         " Go to type definition
nmap gI <Action>(GotoImplementation)          " Go to implementation
nmap gA <Action>(ShowUsages)                  " Go to all references
nmap gs <Action>(FileStructurePopup)          " Find symbol in current file
nmap gS <Action>(GotoSymbol)                  " Find symbol in entire project
nmap gh <Action>(QuickJavaDoc)                " Show hover / inline doc
nmap g. <Action>(ShowIntentionActions)        " Code actions menu
nmap cd <Action>(RenameElement)               " Rename symbol
nmap <leader>fd <Action>(ReformatCode)        " Format document
vmap <leader>fd <Action>(ReformatCode)        " Format selection

" ---------------------
" Multi-Cursor / Selection (Zed-style)
" ---------------------
" Add a cursor selecting the next copy of the current word
nmap gl <Action>(SelectNextOccurrence)
vmap gl <Action>(SelectNextOccurrence)

" Add a cursor selecting the previous copy of the current word
nmap gL <Action>(SelectPreviousOccurrence)
vmap gL <Action>(SelectPreviousOccurrence)

" Skip latest word selection, and add next
vmap g> <Action>(SelectNextOccurrenceExcludingCurrent)

" Skip latest word selection, and add previous
vmap g< <Action>(SelectPreviousOccurrenceExcludingCurrent)

" Add a visual selection for every copy of the current word
vmap ga <Action>(SelectAllOccurrences)

" ---------------------
" Smart / Structural Selection
" ---------------------
xmap [x <Action>(EditorSelectWord)        " Expand selection
xmap ]x <Action>(EditorUnSelectWord)      " Shrink selection
nmap [f <Action>(MethodUp)                " Go to previous function
nmap ]f <Action>(MethodDown)              " Go to next function
